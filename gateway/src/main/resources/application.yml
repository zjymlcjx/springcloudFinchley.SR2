server:
  port: 4000
spring:
  application:
    name: gateway
  cloud:
    gateway:
      discovery:
        locator:
          enabled: true
                               #服务名忽略大小写
          lower-case-service-id: true

---
spring:
  cloud:
    gateway:
      default-filters:
      - CustomLocal=true  #应用于每个路由的过滤器列表，但是只试用于下面的filters，java配置无效
      routes:
#      - id: practice
#        uri: http://www.baidu.com
#        predicates:
#        - After=datetime
#        - Before=datetime
#        - Between=datetime,datetime
#        - Cookie=cookieName,cookieValue regular expression
#        - Header=headerName,headerValue regular expression
#        - Host=**.somehost.org
#        - Method=http method
#        - Query=requestParam(required),regular expression(optional)
#        - RemoteAddr=192.168.1.10/16 
#        - Path=
#        filters:
#        - AddRequestParameter=key,value
#        - AddResponseHeader=key,value
#        - Hystrix=myCommandName
#        - PrefixPath=/mypath  #uri添加前缀/mypath
#        - PreserveHostHeader
#        - RequestRateLimiter
#        - RedirectTo=302, http://acme.org
#        - RemoveRequestHeader=requestHeaderName
#        - RemoveResponseHeader=responseHeaderName
#        - RewritePath=/foo/(?<segment>.*), /$\{segment}
#        - SaveSession
#        - SetPath=/{segment}
#        - SetResponseHeader=responseHeaderName, new value
#        - SetStatus=401 (It must be a valid Spring HttpStatus)
#        - StripPrefix=2
#        - Retry
      - id: test-lower-case-service-id
        uri: lb://springboot-service
        predicates:
        - Path=/lower-case/**
        filters:
        - StripPrefix=1
      - id: test-ribbon
        uri: lb://SPRINGBOOT-SERVICE
        predicates:
        - Path=/springboot/**
        filters:
        - StripPrefix=1
        - name: Hystrix
          args:
            name: authHystrixCommand
            fallbackUri: forward:/hystrixTimeout
      - id: test-http
        uri: http://www.baidu.com
        predicates:
        - Path=/forward/**
        filters:
        - StripPrefix=1
          
hystrix:
  command:
    authHystrixCommand:
      execution:
        isolation:
          thread:
            timeoutInMilliseconds: 30000        
            
#ribbon:
#  ReadTimeout: 2000
#  ConnectTimeout: 2000

        
eureka:
  instance:
    prefer-ip-address: true
    instance-id: ${spring.cloud.client.ip-address}:${server.port}
  client:
    service-url:
      defaultZone: http://localhost:2000/eureka/
logging:
  level:
    org.springframework.cloud.gateway: debug